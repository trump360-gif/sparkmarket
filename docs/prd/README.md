# PRD (Product Requirements Document)

## 1. 프로젝트 개요

### 1.1 기본 정보

| 항목 | 내용 |
|------|------|
| 프로젝트명 | 번개장터 클론 - 중고거래 플랫폼 MVP |
| 목적 | P2P 중고 물품 거래 학습 프로젝트 |
| 비전 | "실무 수준의 프로토타입 완성" |
| MVP 기간 | 5-7주 (관리자 페이지 포함) |
| 타겟 | 학습/포트폴리오 (실서비스 준비 아님) |

### 1.2 MVP 목표 (현실화)

Week 7 종료 시:
- ✅ 회원가입: 10-20명 (주변 지인)
- ✅ 상품 등록: 30-50개
- ✅ 거래 완료: 5-10건
- ✅ 관리자 페이지: 상품/유저 관리 가능
- ✅ 배포 완료 (Vercel)

## 2. 타겟 유저 페르소나

### Persona 1: 판매자 (대학생, 23세)
- **니즈**: 빠른 상품 등록 (3분 이내)
- **Pain Point**: 복잡한 폼 싫어함

### Persona 2: 구매자 (직장인, 32세)
- **니즈**: 검색 편의성, 이미지 크게 보기
- **Pain Point**: 가격 흥정 귀찮음

### Persona 3: 관리자 (개발자/운영자, 28세)
- **니즈**: 부적절한 상품 즉시 삭제, 악성 유저 차단, 간단한 통계 확인
- **Pain Point**: SQL 직접 쓰기 번거로움

## 3. MVP 핵심 기능 (5개) ✅ 채팅 제외

### 3.1 회원가입/로그인
- **방식**: 이메일만 (소셜 로그인 제외)
- **보안**: JWT (Access 1h, Refresh 7d)
- **관리자 계정**: 초기 시드 데이터로 1개 생성

### 3.2 상품 CRUD
- **등록**: 제목, 가격, 카테고리(10개), 이미지(1-5장), 설명
- **이미지**: Cloudflare R2 (Presigned URL 업로드)
- **수정/삭제**: 본인 상품만

### 3.3 상품 목록/검색
- **목록**: 최신순 정렬, 무한 스크롤
- **검색**: PostgreSQL Full-text Search (제목만)
- **필터**: 카테고리, 가격 범위

### 3.4 상품 상세
- **UI**: 모달 (Parallel Routes)
- **기능**: 이미지 슬라이드, 판매자 프로필

### 3.5 관리자 페이지
- **접근**: /admin (관리자만, JWT role 체크)
- **기능**:
  - 대시보드: 전체 통계 (유저 수, 상품 수, 거래 완료 수, 오늘 거래 금액, 판매 추이)
  - 상품 관리: 전체 상품 목록, 검색, 상태별 필터, 삭제
  - 유저 관리: 전체 유저 목록, 검색, 계정 상태 변경 (활성/차단)
  - 수수료 관리: 수수료율 설정, 전체/월별 통계, 거래 내역 조회

## 4. Phase 6 추가 기능 (확장 MVP)

### 4.1 UI/UX 개선
- Toast 알림 시스템 (sonner)
- 로딩 스켈레톤 UI
- Next.js Image 최적화
- 에러 바운더리

### 4.2 핵심 거래 기능
- 찜하기 (좋아요) 기능
- 가격 제안 (네고) 기능
- 마이페이지 (내 정보, 내 상품, 구매 내역, 찜 목록, 제안 내역)

### 4.3 검색 개선
- 검색바 UI 개선
- 검색 필터 강화

## 5. 제외 기능 (Phase 2로 미룸)

- ❌ 1:1 채팅 (Socket.io)
- ❌ 소셜 로그인 (카카오, 네이버)
- ❌ 실제 결제 (토스페이먼츠)
- ❌ 에스크로
- ❌ SMS/알림톡
- ❌ 후기/평점
- ❌ 다크 모드
- ❌ 복잡한 관리자 기능 (신고 시스템, 분쟁 관리, 감사 로그, 실시간 차트)
- ❌ SEO 최적화 (JSON-LD)
- ❌ PWA

## 5. 카테고리

1. 디지털/가전
2. 패션의류
3. 패션잡화
4. 뷰티/미용
5. 스포츠/레저
6. 생활/가공식품
7. 도서
8. 가구/인테리어
9. 반려동물용품
10. 기타

## 6. 상품 상태

- `FOR_SALE`: 판매중
- `SOLD`: 판매완료
- `DELETED`: 삭제됨

## 7. 사용자 역할

- `USER`: 일반 사용자
- `ADMIN`: 관리자

## 8. 사용자 상태

- `ACTIVE`: 활성
- `BANNED`: 차단됨

---

## 9. 현재 구현 상태 (2025-11-23)

### ✅ MVP 핵심 기능 구현 완료

#### 3.1 회원가입/로그인 ✅
- **Backend**: JWT 인증 모듈 완성 (Access 1h, Refresh 7d)
- **Frontend**: 로그인/회원가입 페이지, Zustand 상태 관리
- **추가 기능**: 빠른 로그인 버튼 (테스트용)
  - 일반 유저: `test@sparkmarket.com` / `user123456`
  - 관리자: `admin@sparkmarket.com` / `admin123456`

#### 3.2 상품 CRUD ✅
- **Backend**: 상품 CRUD API 완성
- **Frontend**: 상품 등록/수정/삭제 페이지
- **이미지**: Cloudflare R2 Presigned URL 방식 (최대 5개)
- **상태**: FOR_SALE, SOLD, DELETED

#### 3.3 상품 목록/검색 ✅
- **Backend**: 페이지네이션, 검색, 필터 API
- **Frontend**: 무한 스크롤 (20개씩)
- **필터**: 카테고리, 가격 범위, 검색어

#### 3.4 상품 상세 ✅
- **Frontend**: 상품 상세 페이지
- **기능**: 이미지 갤러리, 판매자 정보, 수정/삭제 권한 체크

#### 3.5 관리자 페이지 ✅
- **접근**: `/admin` (JWT role 체크)
- **대시보드**: 6가지 통계 카드
  - 전체 유저, 전체 상품, 판매중 상품, 판매완료
  - 오늘 가입 유저, 오늘 등록 상품, 오늘 거래 금액
  - 최근 7일 판매 추이 그래프
- **상품 관리**: 전체 목록, 검색, 필터, 삭제
- **유저 관리**: 전체 목록, 검색, 차단/활성화
- **수수료 관리**: 수수료율 설정, 전체/월별 통계, 거래 내역 조회

### 📊 구현 진행률

| 기능 | 상태 | 진행률 |
|------|------|--------|
| 회원가입/로그인 | ✅ 완료 | 100% |
| 상품 CRUD | ✅ 완료 | 100% |
| 상품 목록/검색 | ✅ 완료 | 100% |
| 상품 상세 | ✅ 완료 | 100% |
| 관리자 페이지 | ✅ 완료 | 100% |
| **전체 MVP** | ✅ 완료 | 100% |

### 🎯 다음 단계

#### 필수 (MVP 완성)
1. **Cloudflare R2 설정** - 이미지 업로드 기능 활성화
2. **로컬 테스트** - 백엔드/프론트엔드 통합 테스트
3. **배포** - Vercel (Frontend) + Railway (Backend)

#### 선택 (Phase 2)
- 1:1 채팅 (Socket.io)
- 소셜 로그인 (카카오, 네이버)
- 실제 결제 (토스페이먼츠)
- 찜하기, 후기/평점
- SEO 최적화, PWA

### 🔗 관련 링크

- **GitHub**: https://github.com/trump360-gif/sparkmarket
- **로컬 Backend**: http://localhost:3001
- **로컬 Frontend**: http://localhost:3000

### 📝 최근 업데이트

#### 2025-11-23
- ✅ Phase 5.8 완료: 수수료 관리 시스템
  - Database: CommissionSettings, Transaction 모델 추가
  - Backend: Commission 모듈, 수수료율 설정/통계 API
  - 구매 시 수수료 자동 계산 및 Transaction 기록
  - Frontend: 관리자 수수료 관리 페이지 (/admin/commission)
  - Migration: 기존 판매 완료 상품 4건 거래 내역 백필 완료
- ✅ Phase 5.7 완료: 구매 기능, R2 이미지 업로드, 관리자 유저 대시보드
  - 구매 기능 구현 (상태 자동 변경)
  - Cloudflare R2 이미지 업로드 연동 완료
  - 관리자 유저 상세 페이지 구현 (/admin/users/[id])
  - 관리자 대시보드 카드 클릭 네비게이션 추가
  - 관리자 유저 목록 클릭 가능
- ✅ Phase 5.6 완료: 관리자 페이지 고도화 및 상품 상세 기능 추가
  - 상품 조회수/채팅 수 트래킹 기능 추가
  - 관리자 대시보드: 오늘 거래 금액, 최근 7일 판매 그래프
  - 상품 목록에 조회수/채팅 수 표시 (👁️ 💬 아이콘)
  - 관리자 상품 대시보드 페이지 구현 (/admin/products/[id])
  - 상품 상세 페이지에 구매하기/문의하기 버튼 추가
- ✅ 프론트엔드 전체 구현 완료
- ✅ 코드 전체 검토 및 오류 수정
- ✅ 빠른 로그인 버튼 추가 (테스트 편의성 개선)
